<div class="wrapper">
  <mat-tab-group [(selectedIndex)]=index mat-align-tabs="center"> 

    <ng-container *ngIf="checkout.hasSupplies()">
      <mat-tab label="Supply Dropoff Date" [disabled]="isFirstTabDisabled">
        <form [formGroup]="supplyDropForm" class="content">
            <mat-radio-group formControlName="deliveryMethod" class="radio-group">
              <mat-radio-button value="FREE">FREE Supply Drop Date</mat-radio-button>
              <mat-radio-button value="CUSTOM">Custom Date (+$45)</mat-radio-button>
            </mat-radio-group>
              <mat-form-field appearance="outline" *ngIf="(supplyDropForm.get('deliveryMethod').value==='FREE')">
                <mat-label>Select a FREE Supply Drop Date</mat-label>
                <mat-select formControlName="freeDate">
                  <mat-option *ngFor="let date of SupplyDropDates" [value]="date.value">
                    {{date.label}}
                  </mat-option>
                  <mat-option *ngIf="SupplyDropDates.length === 0" [value]="N/A" disabled>
                    No Free Pickup dates available
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field appearance="outline" *ngIf="(supplyDropForm.get('deliveryMethod').value==='CUSTOM')">
                <mat-label>Choose a date</mat-label>
                <input matInput [min]="today" [matDatepickerFilter]="myFilter" [matDatepicker]="picker" formControlName="customDate">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Preferred Time</mat-label>
              <mat-select formControlName="time" disableRipple>
                <mat-option *ngFor="let time of preferredTimes" [value]=time>
                  {{time}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <button mat-flat-button type="button" (click)="onNext()" [disabled]="!(supplyDropForm.valid)">Next</button>
        </form>
      </mat-tab>
    </ng-container>

    <mat-tab label="Pickup Date" [disabled]="isSecondTabDisabled">
          <form [formGroup]="pickupForm" class="content">
          <mat-radio-group formControlName="deliveryMethod" class="radio-group">
            <mat-radio-button value="FREE">FREE pickup date</mat-radio-button>
            <mat-radio-button value="CUSTOM">Custom Date (+$45)</mat-radio-button>
          </mat-radio-group>
            <mat-form-field appearance="outline" *ngIf="(pickupForm.get('deliveryMethod').value==='FREE')">
              <mat-label>Select a FREE Pickup Date</mat-label>
              <mat-select formControlName="freeDate">
                <mat-option *ngFor="let date of FreePickupDates" [value]="date.value" [disabled]="(checkout.hasSupplies() && checkout.supplyDropForm.get('date') && (date.value <= checkout.supplyDropForm.get('date').value))">
                  {{date.label}}
                </mat-option>
                <mat-option *ngIf="FreePickupDates.length === 0" [value]="N/A" disabled>
                  No Free Pickup dates available
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field appearance="outline" *ngIf="(pickupForm.get('deliveryMethod').value==='CUSTOM')">
              <mat-label>Choose a date</mat-label>
              <input matInput [min]="pickupMinDate()" [matDatepickerFilter]="myFilter" [matDatepicker]="picker" formControlName="customDate">
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Preferred Time</mat-label>
            <mat-select formControlName="time" disableRipple>
              <mat-option *ngFor="let time of preferredTimes" [value]=time>
                {{time}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button *ngIf="checkout.hasSupplies()" mat-flat-button type="button" (click)="onBack()">Back</button>
          <button mat-flat-button type="button" color="accent" (click)="onSubmit()" [disabled]="!pickupForm.valid && (checkout.hasSupplies() || !supplyDropForm.valid)">Submit</button>
        </form>
    </mat-tab>
  </mat-tab-group>
</div>
